const cardsWrapper=document.querySelector(".cards-wrapper"),buttonClose=document.querySelectorAll(".close-icon"),cardMaster=document.querySelectorAll(".card-master"),buttonBack=document.querySelectorAll(".return-arrow"),advanceButton=document.querySelectorAll(".advance-button"),input_def=document.querySelectorAll(".label_input_def b"),divMask=document.querySelector(".div_mask"),meals=document.querySelectorAll(".meal"),$input1=$("#input1"),$input2=$("#input2"),$input3=$("#input3"),$input4=$("#input4"),$input5=$("#input5"),$input6=$("#input6"),$food1=$("#food1"),$food2=$("#food2"),$food3=$("#food3"),$food4=$("#food4"),$food5=$("#food5"),$food6=$("#food6"),$input7=$("#input7"),$input8=$("#input8"),$input9=$("#input9"),$input10=$("#input10"),$input11=$("#input11"),$input12=$("#input12");var $saveButton=$("#save-button");function CalcFeedAmount(){$input4.val()<5?$input5.val(parseFloat($input3.val()*$input4.val()*.14/1e3).toFixed(2)):$input4.val()>=5&&$input4.val()<10?$input5.val(parseFloat($input3.val()*$input4.val()*.08/1e3).toFixed(2)):$input4.val()>=10&&$input4.val()<20?$input5.val(parseFloat($input3.val()*$input4.val()*.05/1e3).toFixed(2)):$input4.val()>=20&&$input4.val()<50?$input5.val(parseFloat($input3.val()*$input4.val()*.045/1e3).toFixed(2)):$input4.val()>=50&&$input4.val()<150?$input5.val(parseFloat($input3.val()*$input4.val()*.034/1e3).toFixed(2)):$input4.val()>=150&&$input4.val()<250?$input5.val(parseFloat($input3.val()*$input4.val()*.03/1e3).toFixed(2)):$input4.val()>=250&&$input4.val()<400?$input5.val(parseFloat($input3.val()*$input4.val()*.022/1e3).toFixed(2)):$input4.val()>=400&&$input4.val()<600?$input5.val(parseFloat($input3.val()*$input4.val()*.014/1e3).toFixed(2)):$input4.val()>=600&&$input4.val()<800?$input5.val(parseFloat($input3.val()*$input4.val()*.01/1e3).toFixed(2)):$input4.val()>=800&&$input4.val()<1300?$input5.val(parseFloat($input3.val()*$input4.val()*.008/1e3).toFixed(2)):$input4.val()>1300&&$input5.val(parseFloat($input3.val()*$input4.val()*.006/1e3).toFixed(2))}function kindFeed(){$input4.val()<5&&($food1.attr("selected","selected"),$input7.val(5)),$input4.val()>=5&&$input4.val()<10&&($input7.val(4),$input4.val()>=5&&$input4.val()<50&&$food2.attr("selected","selected")),$input4.val()>=10&&$input4.val()<250&&($input7.val(3),$input4.val()>=5&&$input4.val()<50&&$food2.attr("selected","selected"),$input4.val()>=50&&$input4.val()<150&&$food3.attr("selected","selected"),$input4.val()>=150&&$input4.val()<250&&$food4.attr("selected","selected")),$input4.val()>250&&($input7.val(2),$input4.val()>=250&&$input4.val()<800&&$food5.attr("selected","selected"),$input4.val()>=800&&$food6.attr("selected","selected"))}function activeSchedules(){meals.forEach((e=>{e.classList.add("hidden")})),1==$input7.val()&&meals[0].classList.remove("hidden"),2==$input7.val()&&(meals[0].classList.remove("hidden"),meals[1].classList.remove("hidden")),3==$input7.val()&&(meals[0].classList.remove("hidden"),meals[1].classList.remove("hidden"),meals[2].classList.remove("hidden")),4==$input7.val()&&(meals[0].classList.remove("hidden"),meals[1].classList.remove("hidden"),meals[2].classList.remove("hidden"),meals[3].classList.remove("hidden")),5==$input7.val()&&(meals[0].classList.remove("hidden"),meals[1].classList.remove("hidden"),meals[2].classList.remove("hidden"),meals[3].classList.remove("hidden"),meals[4].classList.remove("hidden"))}function openModal(){cardsWrapper.classList.remove("hidden"),divMask.classList.remove("hidden")}function closed(e){cardsWrapper.classList.add("hidden"),divMask.classList.add("hidden")}function back(e){const t=e.className.replace(/[^0-9]/g,"");cardMaster[t-2].classList.remove("hidden"),cardMaster[t-1].classList.add("hidden")}function advance(e){const t=e.className.replace(/[^0-9]/g,"");cardMaster[t-1].classList.add("hidden"),cardMaster[t].classList.remove("hidden")}function reloadRefinEsp(){!function(e){let t=new XMLHttpRequest;t.open("GET",e,!1),t.send(),t.responseText}("http://192.168.15.12/reload_ref")}function PostDataScript(e){let t=[$input1.val(),$input2.val(),$input3.val(),$input4.val(),$input5.val(),$input6.val().replace("%","%25"),$input7.val(),$input8.val(),$input9.val(),$input10.val(),$input11.val(),$input12.val()],a=new XMLHttpRequest,n=((new Date).toLocaleDateString(),"https://script.google.com/macros/s/AKfycbwTHYZ8nnvEAvVDTnod6jMwe3qxpiNu-Ev9wXDxTH4KxtXqbTcMKQuN2zAwcT_fkhMZVQ/exec?ref1="+t[7]);return a.open("GET",n),a.send(),console.log(a.responseText),a.responseText}function GetDataScript(e){let t=new XMLHttpRequest;t.open("GET",e),t.send(),t.onload=function(){let e=t.responseText.split(",");console.log(t.responseText),console.log(e),$("#kind_fish").text(e[1]),$("#age").text(e[2]),$("#amount-fish").text(e[3]),$("#weight-fish").text(e[4]),$("#amount-feed-ideal").text(e[5]),$("#kind-feed").text(e[6]),$("#freq").text(e[7]),$("#feedForMeal").text(parseFloat(e[5]/e[7]).toFixed(2)),""==e[8]?$("#label_ref1").addClass("hidden"):$("#meal1").text(new Date(e[8]).getHours()+":"+new Date(e[8]).getMinutes()),""==e[9]?$("#label_ref2").addClass("hidden"):$("#meal2").text(new Date(e[9]).getHours()+":"+new Date(e[9]).getMinutes()),""==e[10]?$("#label_ref3").addClass("hidden"):$("#meal3").text(new Date(e[10]).getHours()+":"+new Date(e[10]).getMinutes()),""==e[11]?$("#label_ref4").addClass("hidden"):$("#meal4").text(new Date(e[11]).getHours()+":"+new Date(e[11]).getMinutes()),""==e[12]?$("#label_ref5").addClass("hidden"):$("#meal5").text(new Date(e[12]).getHours()+":"+new Date(e[12]).getMinutes())}}$saveButton.on("click",(function(){PostDataScript(""),console.log("Enviado!"),reloadRefinEsp()})),GetDataScript("https://script.google.com/macros/s/AKfycbzVINhZb1BG_tVZfg3Dq4EyvwXeOT5elTru-ODy_AlCVknLi_Hi3k_uDUpk5hGhfcty/exec?read");const TempMetric=document.querySelector("#temp_metric"),phMetric=document.querySelector("#ph_metric"),consumptionStatus=document.querySelector("#consumption_status"),phStatus=document.querySelector("#ph_status"),divPHstatus=document.querySelector("#div_status_ph"),FoodMetric=document.querySelector("#food_metric"),weekCostOutput=document.querySelector("#last_week_cost"),relativeCostOutput=document.querySelector("#relative_cost"),ways=["temp","ph"];setInterval((function(){ways.forEach((e=>{const t=new XMLHttpRequest;t.onreadystatechange=function(){if(4==this.readyState&&200==this.status){if(document.getElementById(e+"_metric").innerHTML=t.responseText,e==ways[0]){const e=parseFloat(t.responseText).toFixed(2);e<16&&(consumptionStatus.innerHTML="0%"),e>=16&&e<=19&&(consumptionStatus.innerHTML="60%"),e>=20&&e<=24&&(consumptionStatus.innerHTML="80%"),e>=25&&e<29&&(consumptionStatus.innerHTML="100%"),e>=30&&e<=32&&(consumptionStatus.innerHTML="80%"),e>32&&(consumptionStatus.innerHTML="0%")}if(e==ways[1]){const e=parseFloat(t.responseText).toFixed(2);(e<5.4||e>9)&&(phStatus.innerHTML="Péssimo",divPHstatus.classList.add("terrible_status")),(e>=5.5&&e<=5.9||e>=8.6&&e<=9)&&(phStatus.innerHTML="Ruim",divPHstatus.classList.add("bad_status")),(e>=6&&e<=6.3||e>=8&&e<=8.5)&&(phStatus.innerHTML="Médio",divPHstatus.classList.add("medium_status")),(e>=6.4&&e<=6.7||e>=7.6&&e<8)&&(phStatus.innerHTML="Bom",divPHstatus.classList.add("god_status")),e>=6.8&&e<=7.5&&(phStatus.innerHTML="Excelente",divPHstatus.classList.add("great_status"))}}},t.open("GET","http://192.168.15.12/"+e+"_value",!0),t.send();const a=new Date;document.getElementById("last_update_"+e).innerHTML=a.getDate()+"/"+(a.getMonth()+1)+" - "+a.getHours()+":"+a.getMinutes()+":"+a.getSeconds()}))}),2e3);let qtdFoodReservoir=5;function getFood(){let e=new XMLHttpRequest;e.open("GET","https://script.google.com/macros/s/AKfycbwqbhTaPlHCuBSQMZe0j8BhNxFctzfLAcqphMOA_SjRbRbH8kUYjt9gOXuhF1vQfoimCg/exec"),e.send(),e.onload=function(){const t=e.responseText;LastData=t.split(",");const a=parseFloat(LastData[0]).toFixed(2);qtdFoodReservoir=a,update=new Date(LastData[1]),FoodMetric.innerHTML=a;const n=parseInt(100*a/5),s=document.querySelector(".progress-bar");s.style.setProperty("--progress",n),s.dataset.content=n.toString()+"%",document.getElementById("last_update_food").innerHTML=update.getDate()+"/"+(update.getMonth()+1)+" - "+update.getHours()+":"+update.getMinutes()}}function getCostInfos(){let e=new XMLHttpRequest;e.open("GET","https://script.google.com/macros/s/AKfycbwl5PcB-M3V8pyeAh95yfImv3gxEk4Nn__lGIAzsuzh3B0ZEmxKpP8451hrwtNbPY_NCA/exec?read"),e.send(),e.onload=function(){let t=e.responseText.split(",");relativeCostOutput.innerHTML="&nbsp"+parseFloat(t[5]).toFixed(2),weekCostOutput.innerHTML="&nbsp"+parseFloat(t[6]).toFixed(2)}}getFood(),getCostInfos(),setTimeout((()=>{const e=document.querySelector(".no_alerts"),t=document.querySelector(".wrapper_alerts"),a=document.createElement("i");if(console.log($(".no_alerts").siblings()),a.onclick=function(){$(a).parent().remove(),e.classList.remove("hidden")},qtdFoodReservoir<.5){fetch("https://api.mynotifier.app",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({apiKey:"0d89eff8-78bc-409a-8c4b-821247d91971",message:"A ração está acabando!",description:"A quantidade de ração disponível no reservatório é inferior a 0.5kg. É hora de reabastecer!",type:"success",project:""})});const n=document.createElement("div"),s=document.createElement("p"),i=document.createElement("i");t.appendChild(n),n.appendChild(s),n.appendChild(a),a.classList.add("close_alert"),a.classList.add("fa"),a.classList.add("fa-close"),i.classList.add("fa-solid"),i.classList.add("fa-triangle-exclamation"),n.classList.add("alert"),n.classList.add("danger_alert");let o=new Date;s.appendChild(i),s.innerText="A quantidade de ração disponível no reservatório é inferior a 0.5kg. É hora de reabastecer! - "+o.getDate()+"/"+(o.getMonth()+1)+" - "+o.getHours()+":"+o.getMinutes(),e.classList.add("hidden")}}),2500);